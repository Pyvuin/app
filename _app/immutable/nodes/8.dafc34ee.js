import{s as T}from"../chunks/appwrite.67c106c1.js";import{S as J,i as K,s as R,e as U,b as M,H as j,h,o as G,j as Q,w as W,q as B,r as N,k as w,a as V,l as k,m as y,c as O,n as _,D as g,O as q,L as S,T as X,P as Y,u as C,J as Z,K as z}from"../chunks/index.0bd6f15b.js";import"../chunks/singletons.9a357d20.js";async function x({params:n}){let e=n.id,t=await T.getMsgs(e);return t=t.documents,{tid:e,msgs:t}}const oe=Object.freeze(Object.defineProperty({__proto__:null,load:x},Symbol.toStringTag,{value:"Module"}));function A(n,e,t){const s=n.slice();return s[12]=e[t],s}function $(n){let e;return{c(){e=B("...")},l(t){e=N(t,"...")},m(t,s){M(t,e,s)},p:j,d(t){t&&h(e)}}}function ee(n){let e,t,s,l,c,o,p,i,m,E,d=n[0].msgs,a=[];for(let r=0;r<d.length;r+=1)a[r]=F(A(n,d,r));function D(r,b){return r[3]?se:te}let u=D(n),v=u(n);return{c(){e=w("div");for(let r=0;r<a.length;r+=1)a[r].c();t=V(),s=w("div"),l=w("div"),c=w("form"),o=w("input"),p=V(),i=w("button"),v.c(),this.h()},l(r){e=k(r,"DIV",{class:!0});var b=y(e);for(let P=0;P<a.length;P+=1)a[P].l(b);b.forEach(h),t=O(r),s=k(r,"DIV",{class:!0});var f=y(s);l=k(f,"DIV",{class:!0});var I=y(l);c=k(I,"FORM",{class:!0});var H=y(c);o=k(H,"INPUT",{type:!0,class:!0}),H.forEach(h),p=O(I),i=k(I,"BUTTON",{class:!0});var L=y(i);v.l(L),L.forEach(h),I.forEach(h),f.forEach(h),this.h()},h(){_(e,"class","h-[40vh] chats overflow-auto overflow-y-scroll  svelte-jectb1"),_(o,"type","text"),_(o,"class","w-full input input-bordered mr-4"),_(c,"class","flex w-full"),_(i,"class","btn btn-secondary font-bold"),_(l,"class","flex w-full"),_(s,"class","flex flex-col w-full")},m(r,b){M(r,e,b);for(let f=0;f<a.length;f+=1)a[f]&&a[f].m(e,null);n[6](e),M(r,t,b),M(r,s,b),g(s,l),g(l,c),g(c,o),q(o,n[5]),g(l,p),g(l,i),v.m(i,null),m||(E=[S(o,"input",n[7]),S(c,"submit",n[8]),S(i,"click",n[9])],m=!0)},p(r,b){if(b&17){d=r[0].msgs;let f;for(f=0;f<d.length;f+=1){const I=A(r,d,f);a[f]?a[f].p(I,b):(a[f]=F(I),a[f].c(),a[f].m(e,null))}for(;f<a.length;f+=1)a[f].d(1);a.length=d.length}b&32&&o.value!==r[5]&&q(o,r[5]),u!==(u=D(r))&&(v.d(1),v=u(r),v&&(v.c(),v.m(i,null)))},d(r){r&&h(e),X(a,r),n[6](null),r&&h(t),r&&h(s),v.d(),m=!1,Y(E)}}}function F(n){let e,t,s=n[12].sender+"",l,c,o,p=n[12].msg+"",i,m,E;return{c(){e=w("div"),t=w("div"),l=B(s),c=V(),o=w("div"),i=B(p),m=V(),this.h()},l(d){e=k(d,"DIV",{class:!0});var a=y(e);t=k(a,"DIV",{class:!0});var D=y(t);l=N(D,s),D.forEach(h),c=O(a),o=k(a,"DIV",{class:!0});var u=y(o);i=N(u,p),u.forEach(h),m=O(a),a.forEach(h),this.h()},h(){_(t,"class","chat-header"),_(o,"class","chat-bubble"),_(e,"class",E="chat "+(n[12].sender==n[4]?"chat-end":"chat-start"))},m(d,a){M(d,e,a),g(e,t),g(t,l),g(e,c),g(e,o),g(o,i),g(e,m)},p(d,a){a&1&&s!==(s=d[12].sender+"")&&C(l,s),a&1&&p!==(p=d[12].msg+"")&&C(i,p),a&17&&E!==(E="chat "+(d[12].sender==d[4]?"chat-end":"chat-start"))&&_(e,"class",E)},d(d){d&&h(e)}}}function te(n){let e,t;return{c(){e=Z("svg"),t=Z("path"),this.h()},l(s){e=z(s,"svg",{xmlns:!0,width:!0,height:!0,fill:!0,class:!0,viewBox:!0});var l=y(e);t=z(l,"path",{d:!0}),y(t).forEach(h),l.forEach(h),this.h()},h(){_(t,"d","M15.964.686a.5.5 0 0 0-.65-.65L.767 5.855H.766l-.452.18a.5.5 0 0 0-.082.887l.41.26.001.002 4.995 3.178 3.178 4.995.002.002.26.41a.5.5 0 0 0 .886-.083l6-15Zm-1.833 1.89L6.637 10.07l-.215-.338a.5.5 0 0 0-.154-.154l-.338-.215 7.494-7.494 1.178-.471-.47 1.178Z"),_(e,"xmlns","http://www.w3.org/2000/svg"),_(e,"width","18"),_(e,"height","18"),_(e,"fill","currentColor"),_(e,"class","bi bi-send-fill text-center"),_(e,"viewBox","0 0 16 16")},m(s,l){M(s,e,l),g(e,t)},d(s){s&&h(e)}}}function se(n){let e;return{c(){e=w("span"),this.h()},l(t){e=k(t,"SPAN",{class:!0}),y(e).forEach(h),this.h()},h(){_(e,"class","loading loading-spinner loading-md")},m(t,s){M(t,e,s)},d(t){t&&h(e)}}}function le(n){let e;function t(c,o){return c[2]?ee:$}let s=t(n),l=s(n);return{c(){l.c(),e=U()},l(c){l.l(c),e=U()},m(c,o){l.m(c,o),M(c,e,o)},p(c,[o]){s===(s=t(c))&&l?l.p(c,o):(l.d(1),l=s(c),l&&(l.c(),l.m(e.parentNode,e)))},i:j,o:j,d(c){l.d(c),c&&h(e)}}}function ae(n,e,t){let{data:s}=e,l;const c=async u=>{u.scroll({top:u.scrollHeight,behavior:"smooth"})};let o,p=!1,i;G(async()=>{await T.getlogin()?t(2,o=!0):t(2,o=!1),t(4,i=await T.getsession()),t(4,i=i.name)});let m;Q(()=>{s.msgs&&c(l)}),T.client.subscribe(["databases.647f52807c7ace13086f.collections.6481a5767313b9661654.documents"],async u=>{let v=await T.getMsgs(s.tid);t(0,s.msgs=v.documents,s),t(3,p=!1)});function E(u){W[u?"unshift":"push"](()=>{l=u,t(1,l)})}function d(){m=this.value,t(5,m)}const a=()=>{t(3,p=!0),T.createMsg(s.tid,{type:"chat",msg:m,event:s.tid,sender:i}).then(function(u){}),t(5,m="")},D=()=>{t(3,p=!0),T.createMsg(s.tid,{type:"chat",msg:m,event:s.tid,sender:i}).then(function(u){}),t(5,m="")};return n.$$set=u=>{"data"in u&&t(0,s=u.data)},n.$$.update=()=>{n.$$.dirty&3&&s.msgs&&l&&c(l)},[s,l,o,p,i,m,E,d,a,D]}class ie extends J{constructor(e){super(),K(this,e,ae,le,R,{data:0})}}export{ie as component,oe as universal};
